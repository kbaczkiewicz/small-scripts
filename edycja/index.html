<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Edycja</title>
    <style>
        .container {
            margin: auto;
            width: 768px;
        }

        table {
            width: 100%;
        }

        tr, td {
            border: 1px solid black;
            text-align: center;
        }

        button {
            width: 100%;
        }
    </style>
    <script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
</head>
<body>
<div class="container">
    <table>
        <thead>
        <th>Akcje</th>
        <th>Imię</th>
        <th>Nazwisko</th>
        <th>Data urodzenia</th>
        <th>Kolor drużyny</th>
        <th>Il. punktów</th>
        </thead>
        <tbody>
        <tr class="parent">
            <td data-input="ignore">
                <button class="edit" data-id="1" type="button">Edytuj</button>
            </td>
            <td data-input="text" data-field="name">John</td>
            <td data-input="text" data-field="surname">Doe</td>
            <td data-input="date" data-field="birthDate">27.11.1996</td>
            <td data-input="select" data-field="teamColor">Czerwony</td>
            <td data-input="ignore">255</td>
        </tr>
        <tr class="parent">
            <td data-input="ignore">
                <button class="edit" data-id="2" type="button">Edytuj</button>
            </td>
            <td data-input="text" data-field="name">John</td>
            <td data-input="text" data-field="surname">Doe</td>
            <td data-input="date" data-field="birthDate">27.11.1996</td>
            <td data-input="select" data-field="teamColor">Czerwony</td>
            <td data-input="ignore">255</td>
        </tr>
        <tr class="parent">
            <td data-input="ignore">
                <button class="edit" data-id="3" type="button">Edytuj</button>
            </td>
            <td data-input="text" data-field="name">John</td>
            <td data-input="text" data-field="surname">Doe</td>
            <td data-input="date" data-field="birthDate">27.11.1996</td>
            <td data-input="select" data-field="teamColor">Czerwony</td>
            <td data-input="ignore">255</td>
        </tr>
        <tr class="parent">
            <td data-input="ignore">
                <button class="edit" data-id="4" type="button">Edytuj</button>
            </td>
            <td data-input="text" data-field="name">John</td>
            <td data-input="text" data-field="surname">Doe</td>
            <td data-input="date" data-field="birthDate">27.11.1996</td>
            <td data-input="select" data-field="teamColor">Czerwony</td>
            <td data-input="ignore">255</td>
        </tr>
        <tr class="parent">
            <td data-input="ignore">
                <button class="edit" data-id="5" type="button">Edytuj</button>
            </td>
            <td data-input="text" data-field="name">John</td>
            <td data-input="text" data-field="surname">Doe</td>
            <td data-input="date" data-field="birthDate">27.11.1996</td>
            <td data-input="select" data-field="teamColor">Czerwony</td>
            <td data-input="ignore">255</td>
        </tr>
        <tr class="parent">
            <td data-input="ignore">
                <button class="edit" data-id="6" type="button">Edytuj</button>
            </td>
            <td data-input="text" data-field="name">John</td>
            <td data-input="text" data-field="surname">Doe</td>
            <td data-input="date" data-field="birthDate">27.11.1996</td>
            <td data-input="select" data-field="teamColor">Czerwony</td>
            <td data-input="ignore">255</td>
        </tr>
        <tr class="parent">
            <td data-input="ignore">
                <button class="edit" data-id="7" type="button">Edytuj</button>
            </td>
            <td data-input="text" data-field="name">John</td>
            <td data-input="text" data-field="surname">Doe</td>
            <td data-input="date" data-field="birthDate">27.11.1996</td>
            <td data-input="select" data-field="teamColor">Czerwony</td>
            <td data-input="ignore">255</td>
        </tr>
        </tbody>
    </table>
</div>
<script>
    $(function () {
        selectOptions = {
            red: "Czerwony",
            blue: "Niebieski",
            green: "Zielony",
            yellow: "Żółty"
        }

        function createJsonObject($elems) {
            console.log($elems)
            data = {}
            for (i = 0; i < $elems.length; i++) {
                fieldName = $($elems[i]).data('field')
                data[fieldName] = '' !== $($elems[i]).val()
                    ? $($elems[i]).val()
                    : $($elems[i]).text()
            }

            return data
        }

        function prepareInput($elem) {
            inputType = $($elem).data('input')
            innerText = $($elem).text()
            console.log($elem)
            switch (inputType) {
                case 'text':
                    return $('<input type="text" value="' + innerText + '">')
                case 'date':
                    return $('<input type="date" value="' + innerText + '">')
                    return $elem
                case 'select':
                    return $elem
                default:
                    return $elem
            }
        }

        function changeToInputs($elems) {
            for (i = 0; i < $elems.length; i++) {
                $input = prepareInput($elems[i])
                $($elems[i]).html($($input))
            }
        }

        $('.edit').on('click', function () {
            $editButton = $(this)
            $rows = $editButton.parent().parent()
            changeToInputs($rows.children('td:not([data-input=ignore])'))
            $editButton.replaceWith($('<button class="save" data-id="' + $editButton.data("id") + '" type="button">Zapisz</button>'))
        })

        $(document).on('click', '.save', function () {
            $saveButton = $(this)
            $rows = $saveButton.parent().parent()
            json = JSON.stringify(createJsonObject($rows.children('td')))
            console.log(json)
        })
    })
</script>
</body>
</html>